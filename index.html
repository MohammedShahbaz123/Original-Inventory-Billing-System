<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Inventory & Invoices</title>
  <link rel="stylesheet" href="./Style.css">
  <!-- Include jspreadsheet and jsuites for spreadsheet functionality -->
    <link rel="stylesheet" href="https://jspreadsheet.com/v9/jspreadsheet.css" />
<link rel="stylesheet" href="https://jsuites.net/v4/jsuites.css" />
<script src="https://jsuites.net/v4/jsuites.js"></script>
<script src="https://jspreadsheet.com/v9/jspreadsheet.js"></script>
</head>
<body>
  <header class="sidebar">
    <h2>Inventory & Billing</h2>
    <nav class="sidebar-menu">
      <a href="#" onclick="Navigation.goToDashboard(); return false;" class="sidebar-item active" id="dashboard-nav">
        <span class="sidebar-icon">ğŸ </span>Dashboard
      </a>
      <a href="#" onclick="showPartyManagement(); return false;" class="sidebar-item">
        <span class="sidebar-icon" id="parties-nav">ğŸ‘¥</span>Parties
      </a>
      <a href="#" onclick="showInventoryPage(); return false;" class="sidebar-item">
        <span class="sidebar-icon" id="inventory-nav">ğŸ“¦</span>Inventory
      </a>
      <a href="#" onclick="showSalesPage(); return false;" class="sidebar-item">
        <span class="sidebar-icon" id="sales-nav">ğŸ’°</span>Sales
      </a>
      <a href="#" onclick="showPurchasePage(); return false;" class="sidebar-item">
        <span class="sidebar-icon" id="purchase-nav">ğŸ›’</span>Purchases
      </a>
    </nav>
  </header>

  <main class="content">
    <!-- Dashboard Page -->
    <div id="dashboard" class="page">
      <!-- Content will be populated by dashboard.js -->
      <footer class="footer">
        <div class="footer-content">
          <p>&copy; 2024 Business Management System. All rights reserved.</p>
          <div class="footer-links">
            <span>ğŸ“Š Version 1.0</span>
            <span>ğŸ•’ Last updated: Today</span>
          </div>
        </div>
      </footer> 
    </div>

    <!-- Party Management Page -->
    <div id="party-management" class="page hidden">
      <div class="header">
        <div class="header-left">
          <button onclick="Navigation.goBackToPreviousPage()" class="back-arrow-btn">â†</button>
          <h1>Party Management</h1>
        </div>
        <div class="header-right">
          <button onclick="loadParties()" class="refresh-btn">ğŸ”„ Refresh</button>
        </div>
      </div>
      
      <div class="controls">
        <div class="controls-left">
          <input type="text" id="partiesSearch" placeholder="Search parties..." 
                 class="search-input" onkeyup="filterParties()">
        </div>
        <div class="controls-right">
          <button onclick="showAddPartyForm(); return false;" class="create-btn">+ Add Party</button>
        </div>
      </div>
      
      <div class="page-content">
        <div class="parties-grid" id="parties-list">
          <div class="parties-empty-state">
            <div class="parties-empty-icon">ğŸ‘¥</div>
            <h3>Loading Parties...</h3>
            <p>Please wait while we load your parties</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Create Item Page -->
    <div id="createItem" class="page hidden">
      <div class="header">
        <div class="header-left">
          <button onclick="Navigation.goBackToPreviousPage()" class="back-arrow-btn">â†</button>
          <h1>Add New Item</h1>
        </div>
        <div class="header-right">
          <button onclick="resetItemForm()" class="secondary-btn">ğŸ”„ Reset</button>
        </div>
      </div>
      
      <div class="form-container">
        <form id="itemForm">
          <div class="form-grid">
            <div class="form-group">
              <label for="itemName">Item Name *</label>
              <input type="text" id="itemName" required 
                     placeholder="Enter item name (e.g., Samsung TV, iPhone 15)"
                     maxlength="100">
              <div class="form-hint">Enter a descriptive name for the item</div>
            </div>
            
            <div class="form-group">
              <label for="itemPrice">Price (â‚¹) *</label>
              <div class="input-with-icon">
                <span class="input-icon">â‚¹</span>
                <input type="number" id="itemPrice" required min="0" step="0.01"
                       placeholder="0.00" oninput="formatPrice(this)">
              </div>
              <div class="form-hint">Enter the selling price per unit</div>
            </div>
            
            <div class="form-group">
              <label for="itemStock">Initial Stock *</label>
              <input type="number" id="itemStock" required min="0" step="1"
                     placeholder="0" oninput="validateStock(this)">
              <div class="form-hint">Enter the initial quantity in stock</div>
            </div>
            
            <div class="form-group">
              <label for="itemCategory">Category (Optional)</label>
              <select id="itemCategory">
                <option value="">Select Category</option>
                <option value="electronics">Electronics</option>
                <option value="clothing">Clothing</option>
                <option value="furniture">Furniture</option>
                <option value="groceries">Groceries</option>
                <option value="books">Books</option>
                <option value="other">Other</option>
              </select>
              <div class="form-hint">Categorize for better organization</div>
            </div>
          </div>
          
          <div class="form-actions">
            <button type="button" onclick="Navigation.goBackToPreviousPage()" class="cancel-btn">Cancel</button>
            <button type="submit" class="submit-btn">
              <span id="itemSubmitText">â• Add Item</span>
              <div id="itemLoading" class="loading-spinner" style="display: none;"></div>
            </button>
          </div>
        </form>
      </div>
      
      <div class="quick-templates">
        <h3>ğŸ’¡ Quick Add Common Items</h3>
        <div class="template-buttons">
          <button onclick="fillItemTemplate('Smartphone', 29999, 10)" class="template-btn">ğŸ“± Smartphone â‚¹29,999</button>
          <button onclick="fillItemTemplate('Laptop', 59999, 5)" class="template-btn">ğŸ’» Laptop â‚¹59,999</button>
          <button onclick="fillItemTemplate('Headphones', 2999, 20)" class="template-btn">ğŸ§ Headphones â‚¹2,999</button>
          <button onclick="fillItemTemplate('T-Shirt', 899, 50)" class="template-btn">ğŸ‘• T-Shirt â‚¹899</button>
        </div>
      </div>
    </div>

    <!-- Create Party Page -->
    <div id="createParty" class="page hidden">
      <div class="header">
        <div class="header-left">
          <button onclick="Navigation.goBackToPreviousPage()" class="back-arrow-btn">â†</button>
          <h1>Add New Party</h1>
        </div>
        <div class="header-right">
          <button onclick="resetPartyForm()" class="secondary-btn">ğŸ”„ Reset</button>
        </div>
      </div>
      
      <div class="form-container">
        <form id="partyForm">
          <div class="form-grid">
            <div class="form-group">
              <label for="partyName">Party Name *</label>
              <input type="text" id="partyName" required 
                     placeholder="Enter party name (e.g., John Doe, ABC Corporation)"
                     maxlength="100" oninput="checkPartyExists(this.value)">
              <div id="partyExists" class="error-message" style="display: none;">âš ï¸ This party already exists</div>
              <div class="form-hint">Enter customer or supplier name</div>
            </div>
            
            <div class="form-group">
              <label for="partyType">Party Type *</label>
              <select id="partyType" required onchange="togglePartyFields()">
                <option value="">Select Type</option>
                <option value="customer">Customer</option>
                <option value="supplier">Supplier</option>
                <option value="both">Both (Customer & Supplier)</option>
              </select>
              <div class="form-hint">Select the type of party</div>
            </div>
            
            <!-- In createParty page - update the phone input section -->
<div class="form-group">
    <label for="partyPhone">Phone Number</label>
    <input type="tel" id="partyPhone" 
           placeholder="98765 43210"
           oninput="formatPhone(this)"
           onblur="validatePhoneInput(this)">
    <div class="phone-error error-message" style="display: none;">
        âš ï¸ Please enter a valid 10-digit Indian mobile number starting with 6,7,8,9
    </div>
    <div class="form-hint">Optional 10-digit Indian mobile number</div>
</div>
            
            <div class="form-group">
              <label for="partyEmail">Email Address</label>
              <input type="email" id="partyEmail" 
                     placeholder="party@example.com">
              <div class="form-hint">Optional email address</div>
            </div>
            
            <div class="form-group full-width">
              <label for="partyAddress">Address</label>
              <textarea id="partyAddress" rows="3" 
                        placeholder="Enter complete address..."
                        maxlength="200"></textarea>
              <div class="form-hint">Optional address details</div>
            </div>
          </div>
          
          <div class="form-actions">
            <button type="button" onclick="Navigation.goBackToPreviousPage()" class="cancel-btn">Cancel</button>
            <button type="submit" class="submit-btn">
              <span id="partySubmitText">ğŸ‘¥ Add Party</span>
              <div id="partyLoading" class="loading-spinner" style="display: none;"></div>
            </button>
          </div>
        </form>
      </div>
      
      <div class="existing-parties">
        <h3>ğŸ“‹ Existing Parties</h3>
        <div id="existingPartiesList" class="parties-list">
          <!-- Will be populated by JavaScript -->
        </div>
      </div>
    </div>

    <!-- Invoice View Page -->
<div id="invoiceView" class="page hidden">
    <div class="header">
        <div class="header-left">
            <button onclick="showPage('sales')" class="back-arrow-btn">â† Back to Sales</button>
            <h1>Invoice Details</h1>
        </div>
        <div class="header-right">
            <!-- Download Dropdown -->
            <div class="dropdown">
                <button class="dropdown-btn secondary-btn"><a href="#" onclick="downloadInvoice('pdf'); return false;">ğŸ“¥ Download (PDF)</a>â–¾</button>
                <div class="dropdown-content">
                    <a href="#" onclick="downloadInvoice('thermal'); return false;">ğŸ§¾ Thermal Print</a>
                    <a href="#" onclick="downloadInvoice('duplicate'); return false;">ğŸ“‹ Duplicate</a>
                    <a href="#" onclick="downloadInvoice('triplicate'); return false;">ğŸ“‘ Triplicate</a>
                </div>
            </div>
            <!-- Print Dropdown -->
            <div class="dropdown">
                <button class="dropdown-btn print-btn"><a href="#" onclick="printInvoice('pdf'); return false;">ğŸ–¨ï¸ Print (PDF)</a> â–¾</button>
                <div class="dropdown-content">
                    <a href="#" onclick="printInvoice('thermal'); return false;">ğŸ§¾ Thermal Print</a>
                    <a href="#" onclick="printInvoice('duplicate'); return false;">ğŸ“‹ Print Duplicate</a>
                    <a href="#" onclick="printInvoice('triplicate'); return false;">ğŸ“‘ Print Triplicate</a>
                </div>
            </div>
            
            <button onclick="shareInvoice()" class="secondary-btn" title="Share Invoice">ğŸ“¤ Share</button>
            <button onclick="deleteCurrentInvoice()" class="delete-btn">ğŸ—‘ï¸ Delete</button>
        </div>
    </div>
    <div id="invoiceDetails" class="invoice-view-container">
        <!-- Invoice content will be loaded here -->
    </div>
</div>

    <!-- Sales Invoice Page -->
    <div id="salesInvoice" class="page hidden">
      <div class="header">
        <div class="header-left">
          <button onclick="Navigation.goBackToPreviousPage()" class="back-arrow-btn">â†</button>
          <h1>Create Sale Invoice</h1>
        </div>
        <div class="header-right">
          <button onclick="clearSaleInvoice()" class="secondary-btn">ğŸ—‘ï¸ Clear All</button>
          <button onclick="saveSaleInvoice()" class="primary-btn" id="saveSaleBtn">ğŸ’¾ Save Invoice</button>
        </div>
      </div>
      
      <div class="invoice-container">
        <div class="invoice-header">
          <div class="invoice-meta">
            <div class="meta-group">
              <label for="saleDate">Invoice Date *</label>
              <input type="date" id="saleDate" required>
            </div>
            <div class="meta-group">
              <label for="saleParty">Customer *</label>
              <select id="saleParty" required>
                <option value="">Select Customer</option>
              </select>
              <button type="button" onclick="showPage('createParty')" class="quick-add-btn">+ Add New</button>
            </div>
          </div>
        </div>
        
        <div class="add-items-section">
          <h3>â• Add Items</h3>
          <div class="item-form-grid">
            <div class="form-group">
              <label for="saleItem">Item *</label>
              <input type="text" id="saleItem" list="saleItemsList" 
                     placeholder="Search or select item"
                     oninput="updateItemPrice()">
              <datalist id="saleItemsList"></datalist>
              <div id="itemStockInfo" class="stock-info" style="display: none;"></div>
            </div>
            
            <div class="form-group">
              <label for="saleQty">Quantity *</label>
              <input type="number" id="saleQty" min="1" step="1" 
                     placeholder="0" oninput="calculateSaleSubtotal()">
            </div>
            
            <div class="form-group">
              <label for="salePrice">Price (â‚¹) *</label>
              <input type="number" id="salePrice" min="0.01" step="0.01" 
                     placeholder="0.00" oninput="calculateSaleSubtotal()">
            </div>
            
            <div class="form-group">
              <label for="saleSubtotal">Subtotal</label>
              <input type="text" id="saleSubtotal" readonly 
                     placeholder="0.00" class="readonly-input">
            </div>
            
            <div class="form-group">
              <label>&nbsp;</label>
              <button type="button" onclick="addSaleItemToInvoice()" class="add-item-btn">â• Add to Invoice</button>
            </div>
          </div>
        </div>
        
        <div class="items-table-section">
          <h3>ğŸ“‹ Invoice Items</h3>
          <div id="saleInvoiceTableContainer">
            <table id="saleInvoiceTable" class="data-table">
              <thead>
                <tr>
                  <th>Item</th>
                  <th>Qty</th>
                  <th>Price</th>
                  <th>Subtotal</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="saleInvoiceItems">
                <!-- Items will be added here -->
              </tbody>
              <tfoot>
                <tr class="grand-total">
                  <td colspan="3">Grand Total</td>
                  <td id="saleGrandTotal">â‚¹0.00</td>
                  <td></td>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>
        
        <div class="notes-section">
          <label for="saleNotes">Additional Notes (Optional)</label>
          <textarea id="saleNotes" rows="2" placeholder="Any additional notes for this invoice..."></textarea>
        </div>
      </div>
    </div>

    <!-- Purchase Invoice Page -->
    <div id="purchaseInvoice" class="page hidden">
      <div class="header">
        <div class="header-left">
          <button onclick="Navigation.goBackToPreviousPage()" class="back-arrow-btn">â†</button>
          <h1>Create Purchase Invoice</h1>
        </div>
        <div class="header-right">
          <button onclick="clearPurchaseInvoice()" class="secondary-btn">ğŸ—‘ï¸ Clear All</button>
          <button onclick="savePurchaseInvoice()" class="primary-btn" id="savePurchaseBtn">ğŸ’¾ Save Invoice</button>
        </div>
      </div>
      
      <div class="invoice-container">
        <div class="invoice-header">
          <div class="invoice-meta">
            <div class="meta-group">
              <label for="purchaseDate">Invoice Date *</label>
              <input type="date" id="purchaseDate" required>
            </div>
            <div class="meta-group">
              <label for="purchaseParty">Supplier *</label>
              <select id="purchaseParty" required>
                <option value="">Select Supplier</option>
              </select>
              <button type="button" onclick="showPage('createParty')" class="quick-add-btn">+ Add New</button>
            </div>
          </div>
        </div>
        
        <div class="add-items-section">
          <h3>â• Add Items</h3>
          <div class="item-form-grid">
            <div class="form-group">
              <label for="purchaseItem">Item *</label>
              <input type="text" id="purchaseItem" list="purchaseItemsList" 
                     placeholder="Search or select item"
                     oninput="updatePurchaseItemPrice()">
              <datalist id="purchaseItemsList"></datalist>
              <button type="button" onclick="showPage('createItem')" class="quick-add-btn">+ New Item</button>
            </div>
            
            <div class="form-group">
              <label for="purchaseQty">Quantity *</label>
              <input type="number" id="purchaseQty" min="1" step="1" 
                     placeholder="0" oninput="calculatePurchaseSubtotal()">
            </div>
            
            <div class="form-group">
              <label for="purchasePrice">Price (â‚¹) *</label>
              <input type="number" id="purchasePrice" min="0.01" step="0.01" 
                     placeholder="0.00" oninput="calculatePurchaseSubtotal()">
            </div>
            
            <div class="form-group">
              <label for="purchaseSubtotal">Subtotal</label>
              <input type="text" id="purchaseSubtotal" readonly 
                     placeholder="0.00" class="readonly-input">
            </div>
            
            <div class="form-group">
              <label>&nbsp;</label>
              <button type="button" onclick="addPurchaseItemToInvoice()" class="add-item-btn">â• Add to Invoice</button>
            </div>
          </div>
        </div>
        
        <div class="items-table-section">
          <h3>ğŸ“‹ Purchase Items</h3>
          <div id="purchaseInvoiceTableContainer">
            <table id="purchaseInvoiceTable" class="data-table">
              <thead>
                <tr>
                  <th>Item</th>
                  <th>Qty</th>
                  <th>Price</th>
                  <th>Subtotal</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="purchaseInvoiceItems">
                <!-- Items will be added here -->
              </tbody>
              <tfoot>
                <tr class="grand-total">
                  <td colspan="3">Grand Total</td>
                  <td id="purchaseGrandTotal">â‚¹0.00</td>
                  <td></td>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Sales Page -->
    <div id="sales" class="page hidden">
      <div class="header">
        <div class="header-left">
          <h1>Sales Records</h1>
          <div id="salesGrandTotal" class="total-display">
            <!-- Total sales will be displayed here -->
          </div>
        </div>
        <div class="header-right">
          <button onclick="loadSales()" class="refresh-btn">ğŸ”„ Refresh</button>
        </div>
      </div>
      
      <div class="controls">
        <div class="controls-left">
          <input type="text" id="salesSearch" placeholder="Search by party or invoice..." 
                 class="search-input" onkeyup="filterSales()">
          <select id="salesDateRangeFilter" onchange="filterSalesByDateRange()" class="date-filter">
            <option value="all">All Time</option>
            <option value="today">Today</option>
            <option value="yesterday">Yesterday</option>
            <option value="thisWeek">This Week</option>
            <option value="lastWeek">Last Week</option>
            <option value="thisMonth">This Month</option>
            <option value="lastMonth">Last Month</option>
            <option value="thisYear">This Year</option>
            <option value="lastYear">Last Year</option>
            <option value="custom">Custom Range</option>
          </select>
          
          <div id="salesCustomDateRange" class="custom-date-range">
            <input type="date" id="salesCustomDateFrom">
            <span>to</span>
            <input type="date" id="salesCustomDateTo">
            <button onclick="applySalesCustomDateRange()" class="apply-btn">Apply</button>
          </div>
        </div>
        
        <div class="controls-right">
          <button onclick="showPage('salesInvoice')" class="create-sale-btn">+ Create Sale</button>
        </div>
      </div>
      
      <div id="salesTableContainer">
        <table id="salesTable" class="data-table">
          <!-- Table will be populated by JavaScript -->
        </table>
      </div>
    </div>

    <!-- Purchases Page -->
    <div id="purchases" class="page hidden">
      <div class="header">
        <div class="header-left">
          <h1>Purchase Records</h1>
          <div id="purchasesGrandTotal" class="total-display">
            <!-- Total purchase will be displayed here -->
          </div>
        </div>
        <div class="header-right">
          <button onclick="loadPurchases()" class="refresh-btn">ğŸ”„ Refresh</button>
        </div>
      </div>
      
      <div class="controls">
        <div class="controls-left">
          <input type="text" id="purchasesSearch" placeholder="Search by party or invoice..." 
                 class="search-input" onkeyup="filterPurchases()">
          <select id="dateRangeFilter" onchange="filterByDateRange()" class="date-filter">
            <option value="all">All Time</option>
            <option value="today">Today</option>
            <option value="yesterday">Yesterday</option>
            <option value="thisWeek">This Week</option>
            <option value="lastWeek">Last Week</option>
            <option value="thisMonth">This Month</option>
            <option value="lastMonth">Last Month</option>
            <option value="thisYear">This Year</option>
            <option value="lastYear">Last Year</option>
            <option value="custom">Custom Range</option>
          </select>
          
          <div id="customDateRange" class="custom-date-range">
            <input type="date" id="customDateFrom">
            <span>to</span>
            <input type="date" id="customDateTo">
            <button onclick="applyCustomDateRange()" class="apply-btn">Apply</button>
          </div>
        </div>
        
        <div class="controls-right">
          <button onclick="showPage('purchaseInvoice')" class="create-btn">+ Create Purchase</button>
        </div>
      </div>
      
      <div id="purchasesTableContainer">
        <table id="purchasesTable" class="data-table">
          <!-- Table will be populated by JavaScript -->
        </table>
      </div>
    </div>

    <!-- Inventory Page -->
<div id="inventory" class="page">
    <div class="header">
        <div class="header-left">
            <h1>Inventory</h1>
            <div id="inventorySummary" class="summary-display">
                <!-- Inventory summary will be displayed here -->
            </div>
        </div>
        <div class="header-right">
            <button onclick="loadInventory()" class="refresh-btn">ğŸ”„ Refresh</button>
        </div>
    </div>
    
    <!-- Bulk Actions Panel (shown when items are selected) -->
    <div class="bulk-actions" id="bulkActions" style="display: none;">
        <div class="bulk-controls">
            <span id="selectedCount">0 items selected</span>
            <button onclick="bulkAddStock()" class="bulk-btn">ğŸ“¦ Add Stock</button>
            <button onclick="bulkEditSelectedItems()" class="bulk-btn">âœï¸ Edit Selected</button>
            <button onclick="bulkDeleteItems()" class="bulk-btn delete">ğŸ—‘ï¸ Delete Selected</button>
            <button onclick="clearSelection()" class="bulk-btn cancel">âœ• Clear Selection</button>
        </div>
    </div>
    
    <div class="controls">
        <div class="controls-left">
            <input type="text" id="inventorySearch" placeholder="Search by item name..." 
                   class="search-input" onkeyup="filterInventory()">
            
            <!-- Categories Filter -->
            <select id="categoryFilter" class="category-filter" onchange="filterByCategory()">
                <option value="all">All Categories</option>
                <!-- Categories will be populated dynamically -->
            </select>
             <!-- Add the manage categories button -->
    <button onclick="showManageCategoriesModal()" class="secondary-btn small">
        ğŸ“ Manage
    </button>
        </div>
        
        <div class="controls-right">
            <!-- Bulk Actions Dropdown (Always Visible) -->
            <select id="bulkActionDropdown" class="bulk-action-select" onchange="handleBulkActionChange(this)">
                <option value="">Bulk Actions...</option>
                <option value="bulk-add">ğŸ“¥ Bulk Add Items</option>
                <option value="bulk-edit">âœï¸ Bulk Edit Items</option>
                <option value="add-stock">ğŸ“¦ Add Stock to Selected</option>
                <option value="edit-selected">âš¡ Edit Selected Items</option>
                <option value="delete-selected">ğŸ—‘ï¸ Delete Selected</option>
            </select>
            
            <!-- Category Management -->
            <button onclick="showCreateCategoryModal()" class="category-btn">ğŸ“ Create Category</button>
            <button onclick="showPage('createItem')" class="create-item-btn">+ Add Item</button>
        </div>
    </div>
    
    <div id="inventoryTableContainer">
        <table id="inventoryTable" class="data-table">
            <!-- Table will be populated by JavaScript -->
        </table>
    </div>
</div>

        <!-- Create Category Modal -->
        <div id="createCategoryModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Create New Category</h3>
                    <span class="close" onclick="closeCreateCategoryModal()">&times;</span>
                </div>
                <div class="modal-body">
                    <input type="text" id="newCategoryName" placeholder="Enter category name" class="modal-input">
                    <div class="modal-actions">
                        <button onclick="createNewCategory()" class="confirm-btn">Create Category</button>
                        <button onclick="closeCreateCategoryModal()" class="cancel-btn">Cancel</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Google Sheets Modal -->
        <div id="sheetModal" class="modal hidden">
            <div class="modal-content sheet-modal">
                <div class="modal-header">
                    <h3 id="sheetModalTitle">Bulk Add Items</h3>
                    <div class="modal-header-actions">
                        <button onclick="enlargeSheet()" class="enlarge-btn" title="Enlarge">
                            ğŸ” Enlarge
                        </button>
                        <button onclick="downloadSheetTemplate()" class="download-btn" title="Download Template">
                            ğŸ“¥ Download Template
                        </button>
                        <span class="close" onclick="closeSheetModal()">&times;</span>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="sheet-instructions">
                        <p id="sheetInstructions">
                            <!-- Instructions will be dynamically inserted -->
                        </p>
                    </div>
                    
                    <div class="sheet-container">
                        <div id="spreadsheet"></div>
                    </div>
                    
                    <div class="sheet-actions">
                        <button onclick="addSampleData()" class="sample-data-btn">+ Add Sample Row</button>
                        <div class="action-buttons">
                            <button onclick="closeSheetModal()" class="cancel-btn">Cancel</button>
                            <button onclick="processSheetData()" id="processSheetBtn" class="confirm-btn">
                                ğŸ’¾ Save Items
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enlarged Sheet Modal -->
        <div id="enlargedSheetModal" class="modal hidden">
            <div class="modal-content enlarged-sheet-modal">
                <div class="modal-header">
                    <h3>Google Sheets View - <span id="enlargedSheetTitle">Bulk Add Items</span></h3>
                    <div class="modal-header-actions">
                        <button onclick="syncFromEnlargedSheet()" class="sync-btn" title="Sync back to website">
                            ğŸ”„ Sync to Website
                        </button>
                        <span class="close" onclick="closeEnlargedSheet()">&times;</span>
                    </div>
                </div>
                <div class="modal-body">
                    <div class="enlarged-sheet-container">
                        <iframe id="googleSheetsFrame" src="" style="width: 100%; height: 80vh; border: none;"></iframe>
                    </div>
                </div>
            </div>
        </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="js/supabase-config.js"></script>
<script src="js/utils.js"></script>
<script src="js/supabase-service.js"></script>
<script src="js/parties.js"></script>
<script src="js/inventory.js"></script>
<script src="js/sales.js"></script>
<script src="js/purchases.js"></script>
<script src="js/invoices.js"></script>
<script src="js/dashboard.js"></script>
<script src="js/app.js"></script>
</body>
</html>